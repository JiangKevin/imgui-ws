<html>
    <head>
        <script src="incppect.js"></script>
        <script src="imgui-ws.js"></script>
    </head>

    <body style="font-family: Georgia, serif;" onload="init()">
        <script>
            var has_font = false;
            var tex_font_abuf = null;

            function init() {
                var output = document.createElement('div');
                document.body.appendChild( output );

                imgui_ws.init('canvas_main');

                incppect.render = function() {
                    if (tex_font_abuf === null || tex_font_abuf.byteLength < 1) {
                        tex_font_abuf = incppect.get_abuf('imgui.textures[%d]', 1);
                        if (tex_font_abuf.byteLength < 1) return;
                        return;
                    }

                    if (has_font == false) {
                        has_font = true;

                        imgui_ws.init_font(tex_font_abuf);
                    }

                    var draw_data_abuf = incppect.get_abuf('imgui.draw_data');
                    if (draw_data_abuf.byteLength < 1) return;

                    imgui_ws.gl.clearColor(0.0, 0.0, 0.0, 1.0);
                    imgui_ws.gl.clear(imgui_ws.gl.COLOR_BUFFER_BIT);
                    imgui_ws.gl.viewport(0, 0, imgui_ws.canvas.width, imgui_ws.canvas.height);

                    imgui_ws.render(draw_data_abuf);
                }

                incppect.onerror = function(evt) {
                    if (typeof evt === 'object') {
                        output.innerHTML = 'Error: check console for more information';
                        console.error(evt);
                    } else {
                        output.innerHTML = evt;
                    }
                }

                incppect.onopen = function(evt) {
                }

                incppect.k_requests_update_freq_ms = 50;
                incppect.init();
            }

        </script>

        <div id=main-container align=center width=900px>
            <br><br>
            <canvas id="canvas_main" width="1024px" height="800px" style="border:1px solid #d3d3d3;">Your browser does not support the HTML5 canvas tag.</canvas>
        </div>
    </body>
</html>
